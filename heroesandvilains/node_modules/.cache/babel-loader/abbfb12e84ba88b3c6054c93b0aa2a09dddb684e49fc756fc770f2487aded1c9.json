{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { required, min } from \"vee-validate/dist/rules\";\nimport { extend, ValidationObserver, ValidationProvider, setInteractionMode } from \"vee-validate\";\nsetInteractionMode(\"eager\");\nextend(\"required\", {\n  ...required,\n  message: \"le champe {_field_} est obligatiore\"\n});\nextend(\"min\", {\n  ...min,\n  message: \"le champe {_field_} ne doit pas etre moin de {length} characters\"\n});\nexport default {\n  components: {\n    ValidationObserver,\n    ValidationProvider\n  },\n  data: () => ({\n    existantsMemberId: null,\n    levels: Array.from({\n      length: 100\n    }, (_, i) => i + 1),\n    isEdit: false,\n    member_id: null,\n    heroesIds: [],\n    headers: [{\n      text: \"Identification\",\n      align: \"start\",\n      sortable: true,\n      value: \"_id\"\n    }, {\n      text: \"public Name\",\n      sortable: true,\n      value: \"publicName\"\n    }, {\n      text: \"real Name\",\n      sortable: true,\n      value: \"realName\"\n    }, {\n      text: \"powers\",\n      sortable: true,\n      value: \"powers\"\n    }, {\n      text: \"Actions\",\n      value: \"actions\",\n      sortable: false\n    }],\n    membersDetails: [],\n    dialog: false,\n    publicName: \"\",\n    realName: \"\",\n    powers: [],\n    heroPowers: [],\n    newPower: []\n  }),\n  mounted: async function () {\n    this.fetchMembersDetails();\n    console.log(this.membersDetails);\n    const response = await this.$store.dispatch(\"fetchHeroes\");\n    this.heroesIds = response.data;\n  },\n  computed: {\n    currentTeam: {\n      get() {\n        return this.$store.state.currentTeam;\n      },\n      set(newValue) {\n        this.$store.commit(\"setCurrentTeam\", newValue);\n      }\n    }\n  },\n  methods: {\n    getMemberDetails(memberId) {\n      return this.membersDetails.find(member => member._id === memberId) || {};\n    },\n    async fetchMembersDetails() {\n      if (this.currentTeam && this.currentTeam.members) {\n        try {\n          for (const memberId of this.currentTeam.members) {\n            const heroData = await this.$store.dispatch(\"fetchHeroById\", memberId);\n            const powerNames = heroData.data[0].powers.map(power => power.name);\n            this.membersDetails.push({\n              ...heroData.data[0],\n              powers: powerNames\n            });\n          }\n        } catch (error) {\n          console.error(\"Error fetching members details:\", error);\n        }\n      }\n    },\n    addPower() {\n      const newPower = {\n        name: this.newPower.name,\n        type: null,\n        level: 0\n      };\n      this.heroPowers.push(newPower);\n      this.newPower.name = \"\";\n    },\n    removePower(index) {\n      if (index >= 0 && index < this.heroPowers.length) {\n        this.heroPowers.splice(index, 1);\n      }\n    },\n    async submit() {\n      if (!this.$refs.observer.validate()) {\n        return;\n      }\n      const heroData = {\n        id: this.member_id,\n        publicName: this.publicName,\n        realName: this.realName,\n        powers: this.heroPowers\n      };\n      try {\n        let response = null;\n        if (this.member_id) {\n          console.log({\n            ...heroData,\n            orgSecret: this.$store.state.orgPassword\n          });\n          response = await this.$store.dispatch(\"updateHero\", {\n            ...heroData,\n            orgSecret: this.$store.state.orgPassword.password\n          });\n        } else {\n          response = await this.$store.dispatch(\"createHero\", heroData);\n          // add member to team\n          await this.$store.dispatch(\"updateTeamAddHeroes\", {\n            teamId: this.$store.state.currentTeam._id,\n            addheroes: [response.data._id]\n          });\n        }\n        this.dialog = false;\n        this.publicName = \"\";\n        this.realName = \"\";\n        this.heroPowers = [];\n        this.membersDetails = [];\n        this.fetchMembersDetails();\n      } catch (error) {\n        console.error(\"Error creating hero:\", error);\n      }\n    },\n    async deleteItem(item) {\n      if (confirm(\"tu veux supprimer le member\")) {\n        await this.$store.dispatch(\"updateTeamRemoveHeroes\", {\n          teamId: this.$store.state.currentTeam._id,\n          removeHeroes: [item]\n        });\n        this.membersDetails = [];\n        this.fetchMembersDetails();\n      }\n    },\n    editItem(item) {\n      this.editItem = true;\n      Object.assign({}, item);\n      const editedItem = Object.assign({}, item);\n      this.publicName = editedItem.publicName;\n      this.realName = editedItem.realName;\n      this.member_id = editedItem._id;\n      for (const power of editedItem.powers) {\n        this.heroPowers.push({\n          name: power,\n          type: null,\n          level: null\n        });\n      }\n      this.dialog = true;\n    }\n  },\n  watch: {\n    membersDetails(newVal) {\n      return newVal;\n    },\n    isEdit(newVal) {\n      return newVal;\n    }\n  }\n};","map":{"version":3,"names":["required","min","extend","ValidationObserver","ValidationProvider","setInteractionMode","message","components","data","existantsMemberId","levels","Array","from","length","_","i","isEdit","member_id","heroesIds","headers","text","align","sortable","value","membersDetails","dialog","publicName","realName","powers","heroPowers","newPower","mounted","fetchMembersDetails","console","log","response","$store","dispatch","computed","currentTeam","get","state","set","newValue","commit","methods","getMemberDetails","memberId","find","member","_id","members","heroData","powerNames","map","power","name","push","error","addPower","type","level","removePower","index","splice","submit","$refs","observer","validate","id","orgSecret","orgPassword","password","teamId","addheroes","deleteItem","item","confirm","removeHeroes","editItem","Object","assign","editedItem","watch","newVal"],"sources":["src/components/TeamDetailsComponent.vue"],"sourcesContent":["<template>\n  <div>\n    <v-row justify=\"center\">\n      <v-dialog v-model=\"dialog\" persistent max-width=\"600px\">\n        <template v-slot:activator=\"{ on, attrs }\">\n          <v-btn class=\"mt-5\" color=\"primary\" dark v-bind=\"attrs\" v-on=\"on\">\n            Ajouter Noveau Membre\n          </v-btn>\n        </template>\n        <v-card>\n          <validation-observer ref=\"observer\" v-slot=\"{ invalid }\">\n            <form @submit.prevent=\"submit\">\n              <v-card-title>\n                <span class=\"text-h5\">Member informa  tion</span>\n              </v-card-title>\n              <v-card-text>\n                <v-container>\n                  <v-row>\n                    <span class=\"text-h5\">Selection parmis les existants</span>\n                    <select class=\"custom-select\" v-model=\"existantsMemberId\" label=\"Type\">\n                      <option value=\"null\">selctionner</option>\n                      <option\n                        v-for=\"item in heroesIds\"\n                        :key=\"item._id\"\n                        :value=\"item._id\"\n                      >\n                        {{ item.publicName }} {{ item.realName }}\n                      </option>\n                    </select>\n                  </v-row>\n          \n                  <v-row>\n                    <v-col cols=\"12\">\n                      <validation-provider\n                        v-slot=\"{ errors }\"\n                        name=\"publicName\"\n                        rules=\"required\"\n                      >\n                        <v-text-field\n                          label=\"Public Name*\"\n                          :error-messages=\"errors\"\n                          v-model=\"publicName\"\n                          required\n                        >\n                        </v-text-field>\n                      </validation-provider>\n                    </v-col>\n\n                    <v-col cols=\"12\">\n                      <validation-provider\n                        v-slot=\"{ errors }\"\n                        name=\"realName\"\n                        rules=\"required\"\n                      >\n                        <v-text-field\n                          label=\"real Name*\"\n                          :error-messages=\"errors\"\n                          v-model=\"realName\"\n                          required\n                        >\n                        </v-text-field>\n                      </validation-provider>\n                    </v-col>\n                    <input v-model=\"member_id\" type=\"hidden\" />\n                    <v-col cols=\"12\">\n                      <v-card-text>\n                        <v-card-subtitle>Powers (Optional)</v-card-subtitle>\n                        <v-row>\n                          <v-col cols=\"12\">\n                            <v-card-text>\n                              <v-card-subtitle>Powers</v-card-subtitle>\n                              <div\n                                v-for=\"(power, index) in heroPowers\"\n                                :key=\"index\"\n                              >\n                                <v-row>\n                                  <v-col cols=\"4\">\n                                    <v-text-field\n                                      v-model=\"power.name\"\n                                      label=\"Name\"\n                                    ></v-text-field>\n                                  </v-col>\n                                  <v-col cols=\"4\">\n                                    <v-select\n                                      v-model=\"power.type\"\n                                      :items=\"[1, 2, 3, 4, 5, 6, 7]\"\n                                      label=\"Type\"\n                                      required\n                                    ></v-select>\n                                  </v-col>\n                                  <v-col cols=\"4\">\n                                    <v-select\n                                      v-model=\"power.level\"\n                                      :items=\"levels\"\n                                      label=\"Level\"\n                                      required\n                                    ></v-select>\n                                  </v-col>\n                                  <v-col cols=\"1\">\n                                    <v-icon small @click=\"removePower(index)\">\n                                      mdi-delete\n                                    </v-icon>\n                                  </v-col>\n                                </v-row>\n                              </div>\n                              <v-row align=\"center\" justify=\"space-between\">\n                                <p>Number of Powers: {{ heroPowers.length }}</p>\n                                <v-btn icon small @click=\"addPower\">\n                                  <v-icon>mdi-plus</v-icon>\n                                </v-btn>\n                                <v-btn\n                                  icon\n                                  small\n                                  :disabled=\"heroPowers.length === 0\"\n                                  @click=\"removePower(heroPowers.length - 1)\"\n                                >\n                                  <v-icon>mdi-minus</v-icon>\n                                </v-btn>\n                              </v-row>\n                            </v-card-text>\n                          </v-col>\n                        </v-row>\n                      </v-card-text>\n                    </v-col>\n                  </v-row>\n                </v-container>\n                <small>* c-a-d champ est obligatoire</small>\n              </v-card-text>\n              <v-card-actions>\n                <v-spacer></v-spacer>\n                <v-btn color=\"blue darken-1\" text @click=\"dialog = false\">\n                  Close\n                </v-btn>\n                <v-btn\n                  type=\"submit\"\n                  :disabled=\"invalid\"\n                  color=\"blue darken-1\"\n                  text\n                >\n                  Save\n                </v-btn>\n              </v-card-actions>\n            </form>\n          </validation-observer>\n        </v-card>\n      </v-dialog>\n    </v-row>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"membersDetails\"\n      :items-per-page=\"5\"\n      class=\"elevation-1 mx-3 my-3 mt-5\"\n    >\n      <!-- eslint-disable-next-line vue/valid-v-slot -->\n      <template v-slot:item.actions=\"{ item }\">\n        <v-icon small class=\"mr-2\" @click=\"editItem(item)\"> mdi-pencil </v-icon>\n        <v-icon small @click=\"deleteItem(item)\"> mdi-delete </v-icon>\n      </template>\n    </v-data-table>\n  </div>\n</template>\n\n<script>\nimport { required, min } from \"vee-validate/dist/rules\";\nimport {\n  extend,\n  ValidationObserver,\n  ValidationProvider,\n  setInteractionMode,\n} from \"vee-validate\";\nsetInteractionMode(\"eager\");\n\nextend(\"required\", {\n  ...required,\n  message: \"le champe {_field_} est obligatiore\",\n});\n\nextend(\"min\", {\n  ...min,\n  message: \"le champe {_field_} ne doit pas etre moin de {length} characters\",\n});\nexport default {\n  components: {\n    ValidationObserver,\n    ValidationProvider,\n  },\n  data: () => ({\n    existantsMemberId: null,\n    levels: Array.from({ length: 100 }, (_, i) => i + 1),\n    isEdit: false,\n    member_id: null,\n    heroesIds: [],\n    headers: [\n      {\n        text: \"Identification\",\n        align: \"start\",\n        sortable: true,\n        value: \"_id\",\n      },\n      { text: \"public Name\", sortable: true, value: \"publicName\" },\n      { text: \"real Name\", sortable: true, value: \"realName\" },\n      { text: \"powers\", sortable: true, value: \"powers\" },\n      { text: \"Actions\", value: \"actions\", sortable: false },\n    ],\n    membersDetails: [],\n    dialog: false,\n    publicName: \"\",\n    realName: \"\",\n    powers: [],\n    heroPowers: [],\n    newPower: [],\n  }),\n  mounted: async function () {\n    this.fetchMembersDetails();\n    console.log(this.membersDetails);\n    const response = await this.$store.dispatch(\"fetchHeroes\");\n    this.heroesIds = response.data;\n  },\n  computed: {\n    currentTeam: {\n      get() {\n        return this.$store.state.currentTeam;\n      },\n      set(newValue) {\n        this.$store.commit(\"setCurrentTeam\", newValue);\n      },\n    },\n  },\n\n  methods: {\n    getMemberDetails(memberId) {\n      return (\n        this.membersDetails.find((member) => member._id === memberId) || {}\n      );\n    },\n    async fetchMembersDetails() {\n      if (this.currentTeam && this.currentTeam.members) {\n        try {\n          for (const memberId of this.currentTeam.members) {\n            const heroData = await this.$store.dispatch(\n              \"fetchHeroById\",\n              memberId\n            );\n            const powerNames = heroData.data[0].powers.map(\n              (power) => power.name\n            );\n            this.membersDetails.push({\n              ...heroData.data[0],\n              powers: powerNames,\n            });\n          }\n        } catch (error) {\n          console.error(\"Error fetching members details:\", error);\n        }\n      }\n    },\n\n    addPower() {\n      const newPower = {\n        name: this.newPower.name,\n        type: null,\n        level: 0,\n      };\n      this.heroPowers.push(newPower);\n      this.newPower.name = \"\";\n    },\n    removePower(index) {\n      if (index >= 0 && index < this.heroPowers.length) {\n        this.heroPowers.splice(index, 1);\n      }\n    },\n    async submit() {\n      if (!this.$refs.observer.validate()) {\n        return;\n      }\n\n      const heroData = {\n        id: this.member_id,\n        publicName: this.publicName,\n        realName: this.realName,\n        powers: this.heroPowers,\n      };\n\n      try {\n        let response = null;\n\n        if (this.member_id) {\n          console.log({\n            ...heroData,\n            orgSecret: this.$store.state.orgPassword,\n          });\n          response = await this.$store.dispatch(\"updateHero\", {\n            ...heroData,\n            orgSecret: this.$store.state.orgPassword.password,\n          });\n        } else {\n          response = await this.$store.dispatch(\"createHero\", heroData);\n          // add member to team\n          await this.$store.dispatch(\"updateTeamAddHeroes\", {\n            teamId: this.$store.state.currentTeam._id,\n            addheroes: [response.data._id],\n          });\n        }\n\n        this.dialog = false;\n        this.publicName = \"\";\n        this.realName = \"\";\n        this.heroPowers = [];\n        this.membersDetails = [];\n        this.fetchMembersDetails();\n      } catch (error) {\n        console.error(\"Error creating hero:\", error);\n      }\n    },\n\n    async deleteItem(item) {\n      if (confirm(\"tu veux supprimer le member\")) {\n        await this.$store.dispatch(\"updateTeamRemoveHeroes\", {\n          teamId: this.$store.state.currentTeam._id,\n          removeHeroes: [item],\n        });\n        this.membersDetails = [];\n        this.fetchMembersDetails();\n      }\n    },\n    editItem(item) {\n      this.editItem = true;\n      Object.assign({}, item);\n      const editedItem = Object.assign({}, item);\n      this.publicName = editedItem.publicName;\n      this.realName = editedItem.realName;\n      this.member_id = editedItem._id;\n\n      for (const power of editedItem.powers) {\n        this.heroPowers.push({\n          name: power,\n          type: null,\n          level: null,\n        });\n      }\n\n      this.dialog = true;\n    },\n  },\n\n  watch: {\n    membersDetails(newVal) {\n      return newVal;\n    },\n    isEdit(newVal) {\n      return newVal;\n    },\n  },\n};\n</script>\n\n<style></style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}